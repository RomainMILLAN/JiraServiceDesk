{% trans_default_domain 'app' %}
{% props withActions = false, issue = null %}

<div class="card d-block">
    <div class="card-body">
        {% if withActions %}
            <div class="dropdown card-widgets">
                <a href="#" class="dropdown-toggle arrow-none" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="uil uil-ellipsis-h"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-end">
                    <a href="{{ path('app_issue_edit', {key: issue.key}) }}" class="dropdown-item">
                        <i class="mdi mdi-pencil me-1"></i>{{ 'action.edit'|trans }}
                    </a>

                    <div class="dropdown-divider"></div>

                    {% for transition in issue.transitions %}
                        <form action="{{ path('app_issue_transition_to', {'issueId': issue.id, 'transitionId': transition.id}) }}" method="POST">
                            <button type="submit" class="dropdown-item status-{{ transition.to.statusCategory.colorName }}">
                                {{ 'issue.transition.to'|trans }} "{{ transition.name }}"
                            </button>
                        </form>
                    {% endfor %}
                </div>
            </div>

            <div class="clearfix"></div>
        {% endif %}

        <div class="d-flex flex-row align-items-center justify-content-start">
            <img src="{{ issue.fields.issuetype.iconUrl }}" alt="{{ issue.fields.issuetype.description }}" style="width: 25px;">
            <h3 class="ms-1">{{ issue.fields.summary }}</h3>
        </div>

        <div class="d-flex flex-column flex-md-row col-12">

            <div class="col-3">
                <p class="mt-2 mb-1 text-muted fw-bold font-12 text-uppercase">{{ 'issue.jiraKey.label'|trans }}</p>
                <div class="d-flex">{{ issue.key }}</div>
            </div>

            <div class="col-3">
                <p class="mt-2 mb-1 text-muted fw-bold font-12 text-uppercase">{{ 'issue.assignee.label'|trans }}</p>
                <div class="d-flex">
                    <twig:app:issue:assignee
                        reporter="{{ issue.fields.assignee }}"
                    />
                </div>
            </div>

            <div class="col-3">
                <p class="mt-2 mb-1 text-muted fw-bold font-12 text-uppercase">{{ 'issue.status.label'|trans }}</p>
                <div class="badge status-{{ issue.fields.status.statuscategory.colorName }}">
                    <p class="m-0 p-1 font-14">
                        {{ issue.fields.status.name }}
                    </p>
                </div>
            </div>

            <div class="col-3">
                <p class="mt-2 mb-1 text-muted fw-bold font-12 text-uppercase">{{ 'issue.priority.label'|trans }}</p>
                <div class="d-flex align-items-center gap-1">
                    <img src="{{ issue.fields.priority.iconUrl }}" width="15px" alt="{{ issue.fields.priority.id }}">
                    <div>
                        <h5 class="mt-1 font-14">
                            {{ issue.fields.priority.name }}
                        </h5>
                    </div>
                </div>
            </div>
        </div>


        {% if issue.renderedFields.description is not empty %}
            <h5 class="mt-3">{{ 'issue.description.label'|trans }}</h5>

            <div>
                {{ issue.renderedFields.description|raw }}
            </div>
        {% endif %}

    </div>

</div>
